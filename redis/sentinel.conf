# Redis Sentinel Configuration for Conecta Plus
# High availability and automatic failover

# =============================================================================
# SENTINEL CONFIGURATION
# =============================================================================
port 26379
bind 0.0.0.0

# =============================================================================
# MASTER MONITORING
# =============================================================================
# Monitor the master "conecta-master" with quorum of 1
sentinel monitor conecta-master redis-master 6379 1

# Master password (if authentication is enabled)
# sentinel auth-pass conecta-master your_redis_password_here

# =============================================================================
# FAILOVER CONFIGURATION
# =============================================================================
# Timeout for considering master down (milliseconds)
sentinel down-after-milliseconds conecta-master 5000

# How long to wait for slaves to sync after failover
sentinel failover-timeout conecta-master 60000

# How many slaves can sync with new master simultaneously
sentinel parallel-syncs conecta-master 1

# =============================================================================
# NOTIFICATION SCRIPTS
# =============================================================================
# Script to run when sentinel detects master is down
# sentinel notification-script conecta-master /scripts/notify-master-down.sh

# Script to run when failover is completed
# sentinel client-reconfig-script conecta-master /scripts/reconfig-after-failover.sh

# =============================================================================
# LOGGING
# =============================================================================
loglevel notice
logfile "/var/log/redis/sentinel.log"

# =============================================================================
# ADVANCED CONFIGURATION
# =============================================================================
# Deny dangerous commands
sentinel deny-scripts-reconfig yes

# Working directory
dir "/tmp"

# Maximum number of clients
maxclients 10000

# =============================================================================
# SECURITY
# =============================================================================
# If you want to protect sentinel itself
# requirepass sentinel_password_here

# =============================================================================
# RUNTIME CONFIGURATION
# =============================================================================
# These configurations will be added automatically by Sentinel during runtime
# They track the current state and topology

# sentinel known-replica conecta-master redis-slave 6379
# sentinel current-epoch 1